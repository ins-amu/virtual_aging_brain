import numpy as np
import os
from src import data, simulation
import itertools
from tvb.simulator.lab import *


basedir  = os.path.join(
        "/mnt", "scratch", "scratch", "virtual_aging_cohort_sbi"
)

baseroot  = os.path.join(
        "/mnt", "scratch", "scratch"
)

A_LIST     = [0.0]

P_LIST     = ['sub-0008',
 'sub-0012',
 'sub-0140',
 'sub-0146',
 'sub-0763',
 'sub-0906',
 'sub-1278',
 'sub-1280',
 'sub-1303',
 'sub-1309',
 'sub-1313']

G_LIST     = [2.9618384,
 3.1395926,
 2.0818776,
 1.8156225,
 2.5754605,
 1.9997423,
 2.6424257,
 2.9016507,
 1.9058259,
 2.6662117,
 1.8383265,
 1.6659463,
 3.2275907,
 2.4093109,
 2.4677862,
 3.0471092,
 1.8412488,
 2.6625926,
 1.7984856,
 2.5338452,
 2.223846,
 2.5988413,
 2.026169,
 2.8679142,
 2.6775879,
 2.0526757,
 2.3756662,
 2.8314022,
 2.2635491,
 3.1498051,
 3.043812,
 2.6983116,
 2.9308037,
 1.5095215,
 2.8702681,
 1.5767795,
 3.0732078,
 1.5193512,
 2.1059936,
 2.9827711,
 2.9551355,
 3.2354444,
 1.8869302,
 1.9431469,
 3.030252,
 2.9389118,
 2.4328691,
 2.663704,
 2.7014689,
 2.980873,
 2.3844488,
 2.3871132,
 1.9442639,
 2.3076403,
 3.1107716,
 3.0321167,
 1.8783361,
 2.2896057,
 1.8159113,
 2.9903499,
 1.9918867,
 2.8188515,
 2.9942892,
 1.901349,
 2.1777021,
 1.5855208,
 2.702182,
 3.0222772,
 3.1891662,
 2.9649609,
 3.0210857,
 2.3325476,
 2.4577605,
 1.6608991,
 1.5482321,
 3.2232829,
 1.7192373,
 3.202423,
 2.4163848,
 2.9124406,
 2.5610785,
 2.322196,
 2.0923198,
 1.6623366,
 3.1235607,
 1.6994094,
 1.6399073,
 1.9374049,
 2.6136883,
 2.5903159,
 1.8143487,
 3.0684242,
 1.7514855,
 2.0887242,
 2.1028461,
 1.5861982,
 2.9874534,
 3.0244591,
 1.5233277,
 2.8681034,
 2.4457277,
 2.1269768,
 2.682049,
 1.996678,
 2.6556215,
 2.460228,
 2.7985629,
 3.0379738,
 2.8690817,
 2.1811555,
 2.8180727,
 2.9769359,
 2.2558573,
 2.7666837,
 3.0484779,
 1.7822445,
 1.9761885,
 2.8445811,
 1.6732405,
 1.5245103,
 3.0963933,
 2.9403391,
 1.5381701,
 1.5532021,
 1.635103,
 1.6977178,
 2.5210103,
 2.1184497,
 1.5122104,
 3.1632982,
 1.6814289,
 2.1359691,
 3.0864298,
 3.1727742,
 2.7769667,
 2.7623559,
 2.0340928,
 2.5262881,
 2.7182833,
 3.1332689,
 3.194125,
 1.6776395,
 2.9207716,
 1.7017474,
 2.5429712,
 2.6914338,
 1.9590277,
 2.3495309,
 2.4838189,
 3.1401557,
 1.7955126,
 1.7441492,
 2.9046548,
 1.9554756,
 2.1507057,
 2.8720356,
 2.1510988,
 2.4342982,
 1.943963,
 2.0754538,
 2.7869607,
 1.6434409,
 2.3951114,
 1.9246327,
 2.6827299,
 3.2353151,
 1.6061979,
 2.732359,
 3.2326081,
 3.1533015,
 1.611543,
 1.7591655,
 2.4069154,
 1.6500741,
 2.5725774,
 2.4244687,
 2.2956074,
 2.5102959,
 2.2625964,
 1.6531588,
 1.945475,
 2.5567723,
 3.1057429,
 2.027185,
 3.1722273,
 2.2602885,
 2.073727,
 1.6802938,
 3.2391633,
 2.1501061,
 2.5316403,
 2.8549936,
 1.8869925,
 3.0971822,
 2.1253564,
 3.219394,
 3.1666202,
 1.5289916,
 2.6616496,
 2.8586471,
 2.5719196,
 2.3994027,
 3.1998145,
 1.7885022,
 1.8476088,
 1.7098042,
 3.0064966,
 1.6650509,
 1.5728281,
 2.261593,
 2.9513657,
 2.4757278,
 2.5530921,
 1.7572092,
 2.3284166,
 1.9641268,
 2.8634845,
 2.2691791,
 1.9667357,
 1.8832773,
 2.7533678,
 1.5160024,
 1.501683,
 2.8518825,
 1.7099637,
 2.5681354,
 2.1820052,
 2.0444088,
 3.21813,
 2.5273725,
 2.4036768,
 1.5985434,
 1.6538453,
 2.449647,
 1.5771357,
 2.2894621,
 2.8135212,
 2.7776184,
 2.3813744,
 3.027772,
 2.5173585,
 2.8086108,
 3.0213693,
 1.8830449,
 2.5443534,
 1.782106,
 2.4583169,
 2.9524018,
 1.8749022,
 2.2280604,
 1.7576826,
 2.700828,
 2.7828703,
 1.6315341,
 3.1979653,
 2.1594439,
 3.0224458,
 2.2066125,
 2.5269994,
 1.7761196,
 2.8010344,
 2.7204442,
 3.2273087,
 2.8680212,
 1.6391513,
 3.1137421,
 2.5124257,
 2.3296885,
 2.9814573,
 2.4426387,
 2.0993626,
 2.1767286,
 2.108076,
 2.23084,
 2.3122232,
 2.8606427,
 2.0977903,
 2.8849188,
 2.7532691,
 2.3225566,
 2.6641812,
 2.4127049,
 2.4792801,
 2.4803065,
 3.0419718,
 3.2207503,
 3.1052356,
 3.146882,
 2.9688185,
 2.6567823,
 2.9468955,
 2.92329,
 3.2114501,
 2.0003409,
 2.381458,
 2.8764929,
 2.3090154,
 2.8377633,
 2.7228913,
 3.1893597,
 2.1775862,
 2.8119719,
 1.8068812,
 1.5763343,
 3.131131,
 2.7584214,
 1.6319942,
 3.1355534,
 2.4336638,
 3.2318739,
 2.1051623,
 2.4479232,
 3.059545,
 2.9528441,
 1.9239721,
 2.9058561,
 3.0681573,
 1.7432036,
 3.2463058,
 1.6708935,
 1.7215971,
 2.9186458,
 1.7367312,
 1.9979248,
 1.6619258,
 1.914327,
 1.7069806,
 2.4223254,
 1.6829019,
 2.6256879,
 2.0939747,
 1.6582072,
 2.9773846,
 2.7826015,
 2.2934809,
 1.9697989,
 2.3057073,
 1.9022666,
 2.7972735,
 2.5619942,
 2.6145632,
 2.7681469,
 2.168425,
 2.2336149,
 1.6883038,
 1.6876929,
 3.0829696,
 3.0349715,
 2.819901,
 2.948564,
 3.0661647,
 2.2920866,
 1.5575904,
 3.2180841,
 1.7696337,
 1.9187671,
 2.5546693,
 1.7778465,
 2.3946846,
 2.0014752,
 2.8146156,
 1.7971933,
 2.7528639,
 1.9997625,
 3.2019669,
 1.6316407,
 2.8203502,
 3.1625567,
 3.2071609,
 2.4924135,
 1.5269268,
 3.18423,
 1.782552,
 2.4040259,
 2.7793203,
 3.193039,
 2.5856028,
 2.5763751,
 3.0431683,
 1.8714859,
 1.9043321,
 2.4937455,
 2.0851678,
 2.3049939,
 2.5822823,
 1.8353713,
 1.7441344,
 1.933374,
 2.5674716,
 2.141011,
 2.562498,
 1.858879,
 1.7731493,
 2.6020073,
 1.7147752,
 1.8241691,
 3.23862,
 3.0316869,
 2.1276315,
 1.8416475,
 1.8564014,
 2.548486,
 2.4922089,
 2.9835728,
 2.8922195,
 1.9727857,
 1.6061357,
 2.4261887,
 2.9064418,
 2.7652957,
 3.2278592,
 1.7433928,
 2.3327783,
 1.8120158,
 1.991402,
 1.9987693,
 1.9334792,
 2.5359697,
 2.1479647,
 1.6004065,
 2.4054223,
 2.9721819,
 2.2026642,
 2.8463136,
 2.1125204,
 2.3135613,
 2.7932603,
 2.3622013,
 1.9526815,
 1.9396885,
 2.0411839,
 2.7256342,
 3.0377917,
 2.2560327,
 1.9934607,
 2.8525157,
 2.9489258,
 2.7415837,
 1.560013,
 1.6478026,
 2.5983005,
 2.9747592,
 3.1785562,
 3.1724298,
 1.7426848,
 1.8525357,
 1.8746363,
 2.9011892,
 2.2360229,
 2.8868761,
 2.1433637,
 2.7509549,
 2.352595,
 2.5061546,
 2.0858817,
 1.8608838,
 2.0120314,
 2.0430325,
 3.1854455,
 2.2684401,
 2.1849062,
 2.1499516,
 1.795786,
 1.8751258,
 3.1555082,
 1.8908853,
 2.5409601,
 3.0765415,
 2.9649425,
 2.8822726,
 3.0494309,
 1.7195483,
 2.2939079,
 1.5871599,
 3.0841359,
 2.1707777,
 2.8143448,
 1.5257839,
 3.0573716,
 2.5682906,
 2.3547444,
 2.2221542,
 2.5109452,
 2.4873954,
 1.7502139,
 1.8727877,
 2.2695926,
 2.1051136,
 2.9949322,
 2.8872526,
 2.7758983,
 1.9592983,
 1.7973722,
 2.9222595,
 2.9083937,
 1.532998,
 2.7927371,
 1.6058486,
 3.2062755,
 2.9415969,
 2.4414871,
 2.9612172,
 3.0187552,
 2.4080783,
 2.1742886,
 2.7534474,
 2.6651695,
 2.9985542,
 1.633563,
 3.0517952,
 3.1536674,
 1.5749856,
 2.6441438,
 1.5188564,
 2.3619886,
 2.0698831,
 2.0069545,
 2.3995937,
 1.7126898,
 2.9680084,
 2.1701439,
 2.1777565,
 2.2511949,
 2.6621652,
 1.9212354,
 2.9111183,
 2.363546,
 2.9289287,
 1.5201456,
 1.9593378,
 2.624844,
 3.196879,
 2.8824819,
 2.6809377,
 2.3754718,
 2.8120842,
 2.9080809,
 2.9153996,
 2.4574534,
 1.9308185,
 2.9075883,
 1.9628296,
 2.5275992,
 2.7764225,
 2.8081394,
 2.4161504,
 2.6626211,
 1.6899559,
 1.8298498,
 3.2139837,
 2.6902435,
 2.0736072,
 3.003612,
 1.8218126,
 2.1385029,
 2.3200095,
 1.9110853,
 3.0846087,
 2.5735858,
 2.4012201,
 2.5044346,
 3.168174,
 3.1615327,
 2.4948525,
 2.7844082,
 2.8595874,
 2.9472782,
 1.843474,
 2.2932921,
 2.7900774,
 1.9750044,
 3.2302978,
 2.0452084,
 1.9542903,
 2.740052,
 2.9257676,
 3.043292,
 1.8825234,
 2.3515889,
 2.8382696,
 2.5854795,
 2.4858772,
 2.2962641,
 2.1777581,
 1.6296443,
 2.5327175,
 2.7740048,
 2.9500077,
 2.6125514,
 2.5132523,
 1.915956,
 1.9070532,
 1.7637802,
 2.3960045,
 3.0035824,
 2.1697704,
 2.5689218,
 2.7377971,
 1.7670425,
 1.666627,
 2.7031447,
 2.6993324,
 1.6629917,
 2.9876407,
 1.7174908,
 3.1292363,
 1.7450702,
 2.3847842,
 2.1676079,
 2.7597081,
 1.9159222,
 2.3349269,
 2.7256581,
 1.8671844,
 2.2155772,
 2.0937031,
 3.0038358,
 2.0575012,
 1.5437858,
 2.5958192,
 1.9029093,
 2.0907205,
 1.6117062,
 2.9238033,
 3.0785626,
 1.500387,
 2.8128248,
 2.5948189,
 2.2223927,
 1.9431813,
 1.6000849,
 3.0518589,
 3.0920426,
 2.4940105,
 2.3885053,
 2.1655299,
 1.9356142,
 2.9835037,
 2.5212277,
 3.0556669,
 2.8996464,
 2.2817423,
 2.6222879,
 2.8186573,
 2.6283636,
 1.6331025,
 1.6319629,
 1.5251218,
 3.1703439,
 2.6383567,
 2.1172573,
 2.9456846,
 2.62515,
 3.0828373,
 2.2728094,
 2.6881487,
 2.0352466,
 2.7309283,
 2.1759644,
 2.8978673,
 3.1113322,
 2.9513722,
 2.1385537,
 1.6568205,
 2.5993123,
 1.7998974,
 2.3368566,
 2.8505197,
 1.6390562,
 2.181967,
 3.2047376,
 2.442647,
 1.7968949,
 2.9018304,
 2.0778524,
 2.6709246,
 2.7282199,
 2.7648561,
 2.3527304,
 2.1291993,
 2.5639296,
 2.7833485,
 1.9980689,
 2.0197802,
 3.1028757,
 2.9967445,
 2.2589273,
 1.676644,
 2.6583689,
 2.2779507,
 1.5489815,
 2.1333614,
 1.5503189,
 1.8016749,
 1.5778864,
 3.0924552,
 2.280478,
 2.3862385,
 2.4169512,
 1.7179923,
 1.7248995,
 2.5801227,
 3.1104866,
 3.0088202,
 2.2723724,
 3.2059204,
 3.1270492,
 3.039165,
 2.6657556,
 2.0716881,
 2.0600049,
 2.0032804,
 2.2506812,
 2.2052192,
 2.6592132,
 2.759368,
 1.6397711,
 2.0246887,
 2.0396074,
 2.4520944,
 2.4364637,
 2.2799296,
 1.6668248,
 1.6921793,
 2.5323505,
 1.5136319,
 2.8340982,
 1.8102098,
 3.1475072,
 1.5776034,
 2.3835762,
 1.5156209,
 2.4846198,
 2.5963864,
 2.9866355,
 2.4613349,
 3.0320212,
 2.0044248,
 3.0842193,
 2.1894545,
 2.349798,
 2.6840504,
 1.7562749,
 1.8802889,
 2.7886817,
 1.7250053,
 2.9592176,
 2.8638226,
 1.6784724,
 1.9101687,
 1.7374799,
 2.3178802,
 3.2148158,
 1.8832808,
 1.5801238,
 2.7934704,
 2.4280723,
 3.0972783,
 2.3622238,
 2.6416846,
 2.7785445,
 2.5966295,
 2.6259967,
 2.6487202,
 3.2380583,
 2.8906374,
 1.9282764,
 1.8391824,
 2.5164183,
 2.6785824,
 1.9068463,
 2.9182697,
 2.2266911,
 2.4295822,
 2.9391522,
 2.8228266,
 1.6430542,
 2.4748714,
 2.7608727,
 2.647053,
 3.0199224,
 2.4386269,
 2.0996234,
 2.9614698,
 3.1476894,
 3.030504,
 2.2646329,
 2.8734092,
 2.1513461,
 2.0015825,
 2.0179056,
 2.8555518,
 3.2161544,
 1.6726853,
 2.9221891,
 1.8395821,
 2.9189275,
 2.7777249,
 1.8280766,
 2.9199087,
 3.1177693,
 2.1903998,
 3.0857486,
 3.0723012,
 2.215569,
 1.88398,
 1.532694,
 3.1397137,
 2.3329551,
 2.3883706,
 2.8245495,
 1.9600328,
 1.8205258,
 2.4558895,
 1.9594153,
 1.8426142,
 2.4032039,
 1.6386679,
 1.9735472,
 3.0935006,
 2.4276617,
 1.9664059,
 2.2426214,
 1.7205886,
 2.987918,
 1.522502,
 1.8066372,
 2.3074057,
 3.0374518,
 2.4117054,
 2.8290562,
 2.3269236,
 3.0585021,
 3.0550224,
 1.7929461,
 2.4694547,
 2.0522714,
 2.1867426,
 1.657915,
 2.3163579,
 2.6663639,
 2.713175,
 1.5283238,
 2.5452815,
 1.7632836,
 1.8076087,
 3.0460837,
 1.7499047,
 2.7257478,
 1.6862526,
 2.4301619,
 2.1904219,
 2.7117916,
 1.6961831,
 1.5884722,
 1.7340554,
 2.0121568,
 2.3314456,
 2.496237,
 2.9888714,
 2.0953433,
 1.7714844,
 3.0847772,
 3.1495059,
 2.5947045,
 2.1735149,
 2.6205948,
 2.2983273,
 3.1816686,
 3.0934864,
 1.5782568,
 2.8434461,
 2.3441594,
 3.135757,
 2.9906288,
 2.2793169,
 1.611384,
 1.8464587,
 2.227978,
 2.209672,
 3.1593089,
 1.897188,
 2.7959284,
 2.3880932,
 3.2282322,
 2.0800231,
 1.7903697,
 2.3964633,
 3.0791519,
 3.0411008,
 2.1624921,
 1.8517297,
 1.7067459,
 2.4951457,
 2.5969742,
 2.1731329,
 2.858515,
 3.2096631,
 3.0508608,
 2.1470533,
 2.885072,
 1.6864193,
 2.2245733,
 1.9783022,
 2.1103999,
 2.4652608,
 2.7129575,
 2.4515597,
 3.0684913,
 3.076492,
 2.5351749,
 3.0308462,
 1.8535135,
 2.3437938,
 1.6059066,
 1.6805203,
 2.1666536,
 3.0214926,
 2.9395167,
 2.4698013,
 1.8302792,
 2.8614848,
 1.9739676,
 3.0772338,
 3.1600255,
 2.8411594,
 3.2085146,
 2.5650681,
 1.8998084,
 2.2416722,
 1.53329,
 1.5150484,
 1.8803666,
 2.9685773,
 2.3387241,
 1.6222684,
 2.0218031,
 1.5375829,
 2.0099441,
 2.6596638,
 2.6219286,
 2.0996069,
 2.3051082,
 2.3075058,
 2.9111095,
 2.3887917,
 2.8886005,
 1.5887168,
 2.9291208,
 2.1479571,
 2.6523061,
 2.644319,
 2.4890067,
 1.9203726,
 3.0103088,
 1.6802429,
 2.7497224,
 3.1651551,
 1.8735608,
 2.8480273,
 2.9386188,
 2.3122199,
 2.626704,
 2.4153727,
 2.9172542,
 1.8583568,
 1.8875516,
 2.119194,
 2.79449,
 2.0372484,
 2.3994409,
 1.5509872,
 2.5368704,
 1.5154795,
 2.4639494,
 3.2028074,
 2.5788601,
 3.0063419,
 2.1017799,
 1.6671622,
 1.6176539,
 1.9235297,
 2.7916302,
 1.6792871,
 1.8254275,
 2.1785658,
 2.3155135,
 1.7930534,
 2.3836034,
 1.7443741,
 1.6480121,
 1.5521921,
 2.1446301,
 2.3562152,
 3.2455768,
 2.8321308,
 1.8294795,
 1.8778069,
 3.1496442,
 2.0909645,
 3.1358747,
 1.6766813,
 2.0202489,
 2.3974206,
 2.988357,
 2.8604487,
 1.9535158,
 2.6008984,
 2.1967832,
 1.6702838,
 2.0693225,
 3.0482383,
 1.8809552,
 2.4540709,
 2.90107,
 2.2916902,
 3.122594,
 2.261481,
 1.66604,
 2.2763349,
 2.8360357,
 3.0944183,
 3.1644984,
 1.6725379,
 1.7858447,
 2.8303707,
 2.7360483,
 2.0743108,
 1.539126,
 2.2251087,
 1.6727505,
 2.3418079,
 2.2766219,
 1.5575451,
 1.7319306,
 1.9167936,
 1.9307291,
 1.5701156,
 2.2634345,
 2.8319568,
 2.3502397,
 1.9175202,
 2.6907751,
 3.1360579,
 2.3365701,
 2.5034538,
 2.3946562,
 1.7732327,
 2.3218466,
 3.1145186,
 2.0545415,
 2.9771771,
 1.7071391,
 3.1635706,
 2.6747722,
 2.9512143,
 2.3712629,
 2.3790054,
 2.5734064,
 2.0485135,
 3.0030991,
 2.805794,
 2.1849227,
 3.0979037,
 2.9108632,
 2.7059669,
 1.8806803,
 2.2210136,
 3.0748115,
 2.4274217,
 1.5712503,
 2.2180042,
 2.1988429,
 2.8351527,
 2.8741536,
 1.7872154,
 1.8667054,
 2.6806271,
 2.3323254,
 2.4840457,
 3.1204204,
 1.616141,
 2.1140397,
 1.9949436,
 2.8208729,
 1.7294521,
 1.7528626,
 3.0962513,
 1.9123959,
 2.0017288,
 1.8257595,
 2.1811655,
 2.0556309,
 2.4046292,
 3.1642531,
 1.791276,
 3.0804725,
 2.0009924,
 1.7863783,
 3.031136,
 2.6999725,
 2.055749,
 2.7057271,
 2.8463854,
 1.90223,
 2.3168586,
 1.8034159,
 2.6335925,
 1.518141,
 2.956609,
 2.4647375,
 2.2153252,
 2.9279902,
 1.7856385,
 2.3616838,
 2.6764169,
 1.9608045,
 1.5622049,
 1.7755154,
 2.5998367,
 1.6436377,
 2.7057136,
 2.3681158,
 2.4328156,
 2.8213525,
 3.1179905,
 3.1566684,
 2.1443934,
 2.2355485,
 1.6297283,
 2.6111648,
 1.893208,
 2.8375357,
 1.9830431,
 1.7507348,
 3.0505718,
 1.6051965,
 2.9050973,
 1.5951559,
 1.9072094,
 1.5233848,
 2.8381346,
 1.9556144,
 2.4321102,
 1.6450041,
 1.5535733,
 3.0652478,
 1.6796469,
 2.1442113,
 2.2847817,
 2.7501901,
 1.8317543,
 2.8006351,
 2.1798115,
 2.0011338,
 1.657733,
 2.13118,
 2.6012778,
 1.6652601,
 1.535899,
 2.8070201,
 1.9919039,
 2.0380618,
 2.0245843,
 1.9002348,
 2.7919383,
 3.0203525,
 2.5779079,
 3.1488497,
 2.0990304,
 2.6485156,
 1.7003542,
 2.0635863,
 2.6278561,
 2.9442878,
 2.526807,
 1.7615899,
 1.5891936,
 2.8912463,
 2.1175747,
 2.3079307,
 2.5899445,
 2.0685267,
 2.4670447,
 2.9513684,
 2.203797,
 2.5682349,
 2.7773964,
 2.2004701,
 2.4271451,
 3.1366371,
 2.9286884,
 1.9750857,
 2.6755754,
 2.9030327,
 1.7062659,
 3.1598058,
 2.5826316,
 3.0370673,
 1.8012496,
 1.587231,
 1.7450245,
 1.752706,
 2.0910678,
 3.1077913,
 2.166912,
 2.1177887,
 2.05533,
 1.646957,
 3.070746,
 1.9695781,
 3.0409143,
 2.3039995,
 1.8018006,
 1.9577979,
 1.6463821,
 1.7435119,
 1.7256911,
 2.2502426,
 3.0637823,
 2.6350563,
 1.9112241,
 2.2564704,
 2.3668368,
 2.4603409,
 1.9108978,
 2.7660559,
 2.591051,
 2.7748133,
 3.0244618,
 2.3033048,
 2.9763925,
 1.8282621,
 2.9133859,
 2.033326,
 2.5784428,
 2.1687604,
 2.6385573,
 2.0348623,
 2.2938755,
 3.0278435,
 1.5721104,
 2.132858,
 2.5169885,
 2.3564408,
 2.4270481,
 1.5919989,
 1.576793,
 2.229529,
 2.6293442,
 2.8676733,
 2.3687715,
 2.6955856,
 1.8781852,
 2.9668479,
 3.0840199,
 3.1810276,
 2.5714188,
 2.3636696,
 1.7561599,
 3.151297,
 2.3782958,
 2.3392544,
 3.0550877,
 1.6232242,
 1.8506181,
 1.8692355,
 2.0804777,
 1.8552634,
 2.6270545,
 1.9151954,
 2.9667476,
 2.4734429,
 2.9900746,
 1.9456945,
 2.0399317,
 2.4592113,
 3.0436814,
 2.0132335,
 1.6384011,
 2.7837708,
 2.116524,
 1.5680668,
 1.5255534,
 3.1318395,
 2.500843,
 2.9571162,
 1.6623198,
 3.184562,
 3.1971782,
 1.8652233,
 2.8895518,
 3.0983214,
 2.5140546,
 1.7725155,
 2.1224458,
 2.1945916,
 1.638476,
 2.067202,
 1.8815681,
 2.9116951,
 2.1593964,
 3.1625251,
 2.6754674,
 1.9991613,
 2.8820804,
 1.9467674,
 2.2188849,
 2.4020793,
 3.0341872,
 1.941168,
 2.1850352,
 2.4246686,
 1.5270387,
 3.0869831,
 2.4242648,
 1.613944,
 2.1852787,
 3.0916339,
 1.7664574,
 2.6837008,
 2.3903018,
 1.5314955,
 2.7104618,
 1.5369372,
 2.2122717,
 2.674044,
 3.0775196,
 1.5019087,
 2.8710727,
 2.5824512,
 2.9966032,
 2.0126957,
 1.5120833,
 2.8051184,
 1.5999576,
 2.8317376,
 2.6820864,
 1.8553861,
 1.7366462,
 2.8680838,
 2.9950943,
 1.9157902,
 1.9466506,
 2.7777928,
 2.8298771,
 3.0887038,
 1.8436487,
 1.5657564,
 2.2596077,
 2.2238908,
 2.7533696,
 2.0396332,
 2.0592482,
 2.0383758,
 2.1587863,
 2.440091,
 3.0936409,
 2.9136476,
 1.7559455,
 1.9276144,
 2.341247,
 1.5064573,
 2.4285899,
 1.891469,
 1.5665561,
 2.5197475,
 1.7323556,
 1.5978653,
 1.8769982,
 2.668465,
 2.5701786,
 2.0491404,
 2.3478268,
 1.921347,
 2.5165693,
 2.2508857,
 2.4093577,
 3.1022774,
 1.838914,
 1.7023943,
 1.7886998,
 1.7008736,
 2.6625815,
 2.3917165,
 2.8151658,
 2.0957559,
 2.4101813,
 2.578169,
 3.0652469,
 1.9972654,
 1.8907663,
 1.6541097,
 2.2989944,
 2.6380982,
 2.1180445,
 1.5172084,
 2.2561818,
 1.9129529,
 1.7026219,
 2.3026898,
 2.8392799,
 1.7031199,
 2.7593716,
 2.1125026,
 1.9266207,
 2.7902777,
 2.1491514,
 1.7217403,
 2.643635,
 2.1017103,
 1.6797985,
 2.9284548,
 2.0105134,
 3.101082,
 2.360305,
 1.9990891,
 1.963589,
 2.5950624,
 1.8688853,
 3.145083,
 1.7255387,
 2.0278226,
 1.7198597,
 2.0790349,
 2.4263255,
 2.3769435,
 2.3771328,
 1.8325038,
 1.8889181,
 2.5399127,
 1.7714611,
 2.2233565,
 2.1262502,
 2.4750463,
 2.2257509,
 2.9014887,
 2.7881473,
 1.9827811,
 2.1079166,
 2.7824494,
 3.0456693,
 2.4505955,
 2.8275368,
 1.6346669,
 2.1425448,
 2.2135563,
 3.1126021,
 1.7174614,
 2.7238348,
 2.9221353,
 2.4011507,
 2.7255898,
 2.3423373,
 2.8371499,
 2.4226444,
 2.9781932,
 2.1787302,
 2.3977447,
 2.5185359,
 1.5296346,
 2.6127519,
 2.7983215,
 2.8607594,
 1.7358244,
 2.3893904,
 2.2645907,
 1.5944043,
 1.5711478,
 2.3995275,
 2.6824952,
 1.7002577,
 2.5779866,
 2.8648735,
 2.1529481,
 1.5200715,
 2.6419458,
 1.7000103,
 1.590782,
 1.7216638,
 2.4187509,
 3.0221409,
 2.6584497,
 1.7886817,
 2.6468061,
 2.493802,
 1.8344504,
 2.3637847,
 2.8936771,
 1.7194148,
 2.8241964,
 2.9799064,
 1.9289684,
 2.1486105,
 2.3850299,
 1.7569346,
 1.5270066,
 2.6505385,
 1.7098417,
 3.1350186,
 2.3793801,
 1.8673694,
 2.0465948,
 2.027969,
 2.1446615,
 1.7566788,
 2.1594313,
 1.9266167,
 2.8172997,
 1.876683,
 3.1576637,
 3.1145528,
 2.2943595,
 1.5366734,
 2.9766136,
 2.0533823,
 1.825913,
 1.6715218,
 2.8722342,
 3.1138439,
 3.0929141,
 2.2405258,
 2.7843677,
 1.6967555,
 2.449882,
 2.9073935,
 2.8084331,
 2.5420322,
 3.1459427,
 2.9017824,
 2.0868452,
 2.2606778,
 2.8889887,
 2.5509077,
 2.8687109,
 1.9035219,
 2.436496,
 1.6831297,
 2.4930045,
 1.7269436,
 2.8179032,
 2.5938337,
 1.7873779,
 2.3718056,
 2.1646255,
 2.5818297,
 1.8118463,
 2.7175754,
 3.1637669,
 3.0961546,
 2.837228,
 2.5701872,
 2.8607313,
 2.3817071,
 2.2724067,
 2.5114456,
 1.6669084,
 2.0461089,
 2.0468421,
 2.1022416,
 1.9981832,
 2.8177516,
 1.7432731,
 2.9924744,
 2.8817219,
 2.3748452,
 1.6500312,
 2.9616094,
 2.8025854,
 2.8282333,
 1.635889,
 2.4339759,
 2.786415,
 1.8998458,
 2.5647979,
 1.589696,
 2.0347663,
 2.339153,
 2.2137737,
 2.6699684,
 2.6158717,
 2.1796704,
 2.7637204,
 1.989604,
 2.4860872,
 1.6989884,
 3.1590716,
 1.5137592,
 2.7690895,
 2.0955467,
 2.9895865,
 1.55472,
 2.3672161,
 1.6519262,
 2.9237619,
 2.1298834,
 1.681159,
 2.5939506,
 2.9884418,
 2.1272151,
 2.832849,
 3.129622,
 2.875143,
 2.2956389,
 1.9694547,
 1.9727536,
 2.7067001,
 2.6065754,
 1.5565524,
 1.6716138,
 1.901344,
 3.0097943,
 1.7325679,
 2.9445468,
 1.8946164,
 1.8653397,
 2.4462178,
 2.2194733,
 3.1541045,
 2.9948374,
 1.5682148,
 1.6304207,
 2.0189901,
 2.2236151,
 2.5631937,
 2.0960215,
 3.1365539,
 2.0638417,
 1.764392,
 2.3184103,
 2.3868367,
 2.6522453,
 1.7347633,
 2.9732161,
 1.770765,
 2.7857481,
 2.5908053,
 1.7565666,
 2.344248,
 1.9223568,
 2.3382479,
 2.5136695,
 2.5102139,
 2.046771,
 1.6567367,
 2.4464585,
 1.7795587,
 2.1282543,
 2.6192947,
 2.9185106,
 2.1948828,
 2.4405327,
 2.5546062,
 1.9608913,
 2.3617154,
 3.0309134,
 2.059856,
 1.6007715,
 2.7924364,
 2.4256565,
 2.5862188,
 2.5828353,
 2.9520924,
 2.3299765,
 3.0241058,
 3.1283101,
 2.3413725,
 2.3075581,
 2.3604932,
 2.8341621,
 2.0683309,
 2.1389137,
 2.7149269,
 2.1891979,
 2.7044248,
 2.3507715,
 2.2302943,
 1.5714339,
 2.1405706,
 1.7386594,
 2.6659739,
 2.9867986,
 1.7794374,
 2.6490203,
 2.4740985,
 2.1798595,
 2.4664165,
 2.0532999,
 2.74493,
 2.0825249,
 1.6262612,
 1.8658914,
 3.1474568,
 2.754673,
 3.0355462,
 2.5396104,
 1.6852199,
 2.9370773,
 2.0260126,
 1.5242425,
 1.9787332,
 2.6469089,
 1.8789686,
 1.8435307,
 1.7936471,
 2.8591746,
 2.4656912,
 2.6715173,
 2.4201807,
 1.9437809,
 1.6450845,
 2.7570639,
 2.0959888,
 2.614916,
 1.5203328,
 3.1325755,
 2.8437363,
 1.9104497,
 2.6233289,
 3.136267,
 2.6403799,
 1.8030519,
 2.6493886,
 2.8905436,
 2.2008279,
 3.1471458,
 2.80548,
 2.216679,
 2.4122234,
 2.0320071,
 2.8185171,
 1.5866601,
 1.8597291,
 2.5767671,
 2.0546748,
 2.8530612,
 2.6136151,
 3.0462448,
 2.4568681,
 1.9857003,
 2.5332388,
 1.707621,
 1.7575637,
 2.3796756,
 1.8691097,
 2.1303991,
 2.8304806,
 1.6505427,
 2.4956543,
 2.8574846,
 2.8265104,
 2.362534,
 2.3960444,
 2.598038,
 3.132068,
 2.1697059,
 1.5939487,
 1.6693967,
 2.0650116,
 2.737513,
 3.1359564,
 1.8647467,
 2.8744144,
 1.9295807,
 2.209358,
 3.163437,
 2.5164603,
 1.9528512,
 1.7249025,
 1.5861605,
 1.6236867,
 2.6041435,
 2.0715346,
 2.6547575,
 1.5610723,
 2.5545298,
 1.7031621,
 1.522686,
 2.297591,
 1.6686311,
 3.1457336,
 2.6768355,
 2.5042193,
 1.7655719,
 2.4741986,
 3.0096982,
 2.2434152,
 1.9838263,
 2.0773217,
 2.7272304,
 3.1800492,
 2.5416816,
 2.1992267,
 2.4964018,
 2.4227682,
 1.656346,
 2.7631737,
 2.9718053,
 3.0986414,
 1.6930099,
 2.0071652,
 1.8236505,
 2.1152414,
 1.9448854,
 2.1596726,
 1.9526043,
 2.859394,
 2.7150089,
 1.6586491,
 1.5442113,
 1.8415268,
 2.8107079,
 2.3457236,
 1.9514873,
 2.0416536,
 1.9725651,
 2.3164141,
 2.5235777,
 2.997603,
 2.7777559,
 1.6056351,
 2.8046297,
 2.9405265,
 2.8164091,
 2.6995172,
 1.6241643,
 1.5251301,
 2.710073,
 2.9638364,
 2.3885687,
 1.5867397,
 2.3689916,
 3.1813976,
 2.0458253,
 1.7956211,
 2.2325662,
 2.6546388,
 2.2895956,
 2.7887972,
 2.9324552,
 2.5670211,
 2.0822392,
 3.0491541,
 3.0048629,
 1.6795363,
 1.6450189,
 1.9339014,
 2.1745167,
 1.6425883,
 2.1377676,
 2.1329136,
 2.0804108,
 2.0980855,
 2.3472711,
 2.8637515,
 2.8987385,
 2.4302116,
 3.0068655,
 2.704548,
 1.7744773,
 2.6282267,
 1.6391998,
 1.6179813,
 2.7831319,
 1.5358739,
 3.0912717,
 1.5987251,
 2.5675355,
 1.7356953,
 2.528795,
 1.7799533,
 2.2991824,
 1.7250257,
 3.1750773,
 2.2384437,
 2.0813383,
 2.6956298,
 2.5066058,
 1.6965351,
 3.0266765,
 2.5361295,
 1.5619365,
 1.779256,
 2.0726007,
 3.1528284,
 2.8688973,
 2.0293775,
 2.0702411,
 1.9611254,
 3.1304449,
 1.9766588,
 2.4634357,
 2.6444297,
 1.6126569,
 1.9552957,
 3.1351754,
 2.6561085,
 2.7034964,
 3.0353009,
 2.4907158,
 2.1245119,
 3.0099023,
 3.1876239,
 2.6285018,
 2.8219109,
 1.7079155,
 2.1597936,
 2.9003207,
 1.6375874,
 2.7289795,
 1.6049121,
 2.7130926,
 2.7346336,
 2.4182501,
 1.9850135,
 2.1067974,
 3.1018457,
 2.22473,
 2.1405537,
 2.0727197,
 2.9672314,
 2.6206786,
 3.1405955,
 2.0250035,
 3.0735071,
 1.7857547,
 2.7050749,
 1.8520572,
 2.8462962,
 3.1501193,
 2.5035828,
 2.5949717,
 1.917352,
 1.788818,
 2.7207303,
 2.8008292,
 2.900183,
 2.4071634,
 1.9432581,
 2.6995277,
 3.0672856,
 3.1334548,
 1.8497643,
 1.5667238,
 2.0500154,
 2.4081552,
 2.0806769,
 2.0331337,
 1.6848447,
 3.0169966,
 2.7286077,
 2.1449243,
 1.6678758,
 2.0245552,
 1.5467597,
 2.1609337,
 1.698768,
 2.986444,
 1.5348531,
 1.5417594,
 2.3665119,
 2.7243834,
 2.624424,
 2.4441179,
 2.7352433,
 2.0622638,
 2.3631344,
 2.0185369,
 1.802383,
 1.5054522,
 2.5240094,
 2.2892713,
 2.7004224,
 1.6383615,
 3.1450586,
 2.885506,
 2.1034855,
 1.9658845,
 1.7950527,
 1.5235312,
 2.5828345,
 1.5492581,
 1.8941153,
 1.5369422,
 3.1078637,
 2.3839365,
 1.7838508,
 2.4574454,
 1.9559664,
 3.0842261,
 2.5792039,
 2.2555414,
 2.7956507,
 2.5049841,
 2.4552386,
 3.1472196,
 2.3485284,
 2.067689,
 1.9535876,
 1.7769446]

SIM_BATCH  = 4

def chunks(lst, n):
    """Yield successive n-sized chunks from lst."""
    for i in range(0, len(lst), n):
        yield lst[i:i + n]

sims = list(itertools.product(P_LIST, G_LIST, A_LIST))

rule target:
    input:[os.path.join(baseroot,f"OUT_VIRT_COH_SBI/batch_pone_{i}.done") for i in range((len(G_LIST)*len(P_LIST)*len(A_LIST)) // SIM_BATCH)]

rule simulate:
    output:
        os.path.join(basedir, "julich_data_group_rs_pat{pat}_G{G}_alpha1{a}_cohort_heun.npz")
    group: "simgroup"
    shell:
        "python scripts/run_vab_github_noise.py -G {wildcards.G} -o {output} -p {wildcards.pat} -a {wildcards.a} -l 30000"

for i, chunk in enumerate(chunks(sims, SIM_BATCH)):
    rule:
        input: [os.path.join(basedir, f"julich_data_group_rs_pat{pat}_G{G}_alpha1{a}_cohort_heun.npz") for (pat,G,a) in chunk]
        group: "simgroup"
        output: touch(os.path.join(baseroot,f"OUT_VIRT_COH_SBI/batch_pone_{i}.done"))
